# :beach_umbrella:  IMC Prosperity Backtester  :palm_tree:

:tada: Three Kingdoms' in-house backtester for IMC Prosperity 3.

## Files & Directories

- **main.py**  
  Runs the trading algorithms and matches them against resting orders and past trades.
- **driller.py**  
  Defines a placeholder algorithm for drilling market data from the official sandbox.
- **extractor.py**  
  Parses data from the official logs generated by `driller.py`.
- **matcher.py**  
  Order matching engine that provides utilities to facilitate order matching.
- **data/**  
  Contains the drilled data for each round.
- **results/**  
  Stores backtesting results, including an orderbook CSV, a PnL vs time plot, and a trade history CSV.
- **algorithms/**  
  Directory for storing your algorithms to backtest.

## How to Use

To run the backtester from the command line, run the command `python main.py` followed by the following command-line arguments *in order*. If one or more arguments are missing, the flags are interpreted based on their positions and the remaining parameters are set to default values. If no arguments are provided, it defaults to testing `algorithms/algo.py` on round 0 data. For meaningful results, the first two arguments (round number and algorithm path) are usually needed.

1. **Round number**  
   - **Description:** the round of data to backtest on.
   - **Constraints:** integer between 0 and 5 (inclusive).
   - **Default:** `0`
2. **Algorithm path**  
   - **Description:** the file path to your algorithm.
   - **Constraints:** valid file path.
   - **Default:** `algorithms/algo.py` (an empty placeholder).
3. **Log length**  
   - **Description:** the length of the logs.
   - **Constraints:** positive integer.
   - **Default:** `None` (logs everything).
4. **Verbose**  
   - **Description:** determines whether to print detailed information to the command line.
   - **Constraints:** accepts one of: `0`, `1`, `"true"`, `"false"`, `"yes"`, `"no"`, `"是"`, `"否"` (both `是` and `否` work!).
   - **Default:** `否`

## Example Commands

Execute these commands from the project root repository:

```bash
python main.py 1 algorithms/monkeys_eat_bananas.py

python main.py 3 algorithms/猴子吃香蕉.py 314 1

python main.py 5 algorithms/啦啦啦啦啦.py 100 否
```

## Backtest Output

The backtest output is stored in the `results/round-x` directory and includes the following three files:

1. **`orderbook.csv`** – A CSV file containing the order book and PnL at every timestamp.
2. **`pnl_over_time.png`** – A plot of PnL over time.
3. **`trade_history.csv`** – A CSV file containing the history of all of *your own* trades.
